<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.34" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />

    <title>Go, OpenCV, Caffe, and Tensorflow: Putting It All Together With GoCV :: GoCV - Golang Computer Vision Using OpenCV 3</title>
    
    
    <link href="/css/nucleus.css?1516791598" rel="stylesheet">
    <link href="/css/font-awesome.min.css?1516791598" rel="stylesheet">
    <link href="/css/hybrid.css?1516791598" rel="stylesheet">
    <link href="/css/featherlight.min.css?1516791598" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1516791598" rel="stylesheet">
    <link href="/css/auto-complete.css?1516791598" rel="stylesheet">
    <link href="/css/theme.css?1516791598" rel="stylesheet">
    <link href="/css/hugo-theme.css?1516791598" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1516791598"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-46433484-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-46433484-8');
</script>

  </head>
  <body class="" data-url="/blog/2018-01-23-go-opencv-tensorflow-caffe/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <html>
<a href="http://gocv.io"><img src="https://raw.githubusercontent.com/hybridgroup/gocv/master/images/gocvlogo.jpg">
<h2 style="color:white; margin:0;">GoCV</h2>
<h4 style="color:white; margin:0;">Computer Vision using Go and OpenCV 3</h4></a>
</html>
    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/computer-vision/" title="Computer Vision" class="dd-item 
        
        
        
        ">
      <a href="/computer-vision/">
          Computer Vision
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/getting-started/linux/" title="Linux" class="dd-item ">
        <a href="/getting-started/linux/">
        Linux
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/getting-started/osx/" title="OS X" class="dd-item ">
        <a href="/getting-started/osx/">
        OS X
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/getting-started/windows/" title="Windows" class="dd-item ">
        <a href="/getting-started/windows/">
        Windows
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/writing-code/" title="Writing Code" class="dd-item 
        
        
        
        ">
      <a href="/writing-code/">
          Writing Code
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/writing-code/hello-video/" title="Hello Video" class="dd-item ">
        <a href="/writing-code/hello-video/">
        Hello Video
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/writing-code/face-detect/" title="Face Detect" class="dd-item ">
        <a href="/writing-code/face-detect/">
        Face Detect
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/writing-code/more-examples/" title="More Examples" class="dd-item ">
        <a href="/writing-code/more-examples/">
        More Examples
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/blog/" title="Blog" class="dd-item 
        parent
        
        
        ">
      <a href="/blog/">
          Blog
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/blog/2018-01-23-go-opencv-tensorflow-caffe/" title="Go, OpenCV, Caffe, and Tensorflow: Putting It All Together With GoCV" class="dd-item active">
        <a href="/blog/2018-01-23-go-opencv-tensorflow-caffe/">
        Go, OpenCV, Caffe, and Tensorflow: Putting It All Together With GoCV
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/2017-12-14-putting-eyes-on-the-iot-video/" title="Putting Eyes on the IoT - The Video" class="dd-item ">
        <a href="/blog/2017-12-14-putting-eyes-on-the-iot-video/">
        Putting Eyes on the IoT - The Video
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/2017-12-14-gocv-the-blog/" title="Introducing the GoCV Blog" class="dd-item ">
        <a href="/blog/2017-12-14-gocv-the-blog/">
        Introducing the GoCV Blog
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li class="" role=""> 
                  <a class="padding" href="https://github.com/hybridgroup/gocv"><i class='fa fa-github'></i> Github repo</a>
              </li>
          
              <li class="" role=""> 
                  <a class="padding" href="https://godoc.org/gocv.io/x/gocv"><i class='fa fa-book'></i> Godoc</a>
              </li>
          
              <li class="" role=""> 
                  <a class="padding" href="https://twitter.com/GoCVio"><i class='fa fa-twitter'></i> Twitter</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <center>
    Like what you see? Give GoCV a star!

    
    <a class="github-button" href="https://github.com/hybridgroup/gocv" data-icon="octicon-star" data-show-count="true" aria-label="Star GoCV on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/hybridgroup/gocv/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork GoCV on GitHub">Fork</a>

    <p>GoCV created by <a href="https://hybridgroup.com">The Hybrid Group</a></p>
    <p></p>
    <p>Site built with <a href="http://gohugo.io/">Hugo</a></p>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable sticky-parent">
              
              <div class="sticky-spacer">
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" href="https://github.com/hybridgroup/gocv-site/edit/master/content/blog/2018-01-23-go-opencv-tensorflow-caffe.md" target="blank">
                      <i class="fa fa-code-fork"></i>
                      Edit this page
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Home</a> > <a href='/blog/'>Blog</a> > Go, OpenCV, Caffe, and Tensorflow: Putting It All Together With GoCV
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#we-re-going-deep">We&rsquo;re Going Deep</a></li>
<li><a href="#recognizing-faces-with-the-intel-computer-vision-sdk-beta-r3">Recognizing Faces With The Intel Computer Vision SDK Beta R3</a></li>
<li><a href="#and-there-s-even-more">And There&rsquo;s Even More</a></li>
<li><a href="#keep-sight-of-what-we-re-up-to">Keep Sight of What We&rsquo;re Up To</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Go, OpenCV, Caffe, and Tensorflow: Putting It All Together With GoCV</h1>
          

        




<p>We are pleased to present to you the new GoCV (<a href="https://gocv.io">https://gocv.io</a>) version 0.8.0, which is our first release of 2018. This is a big update and adds a lot of powerful new functionality, along with bug fixes and more documentation, thanks to our wonderful contributors.</p>

<p>The new version adds support for the <a href="https://docs.opencv.org/3.4.0/d6/d0f/group__dnn.html">OpenCV Deep Neural Network (DNN) module</a>, which means you can now use Caffe (<a href="http://caffe.berkeleyvision.org/">http://caffe.berkeleyvision.org/</a>) and Tensorflow (<a href="https://www.tensorflow.org/">https://www.tensorflow.org/</a>) models from your GoCV code. GoCV also now has complete support for the latest <a href="https://software.intel.com/en-us/cvsdk-devguide-advanced-face-capabilities-in-intels-opencv">Intel Computer Vision SDK Beta R3</a> including face recognition.</p>

<p>There is lots more, check out the full changelog at <a href="https://github.com/hybridgroup/gocv/blob/master/CHANGELOG.md#080">https://github.com/hybridgroup/gocv/blob/master/CHANGELOG.md#080</a> for complete details, or read on for the highlights.</p>

<h3 id="we-re-going-deep">We&rsquo;re Going Deep</h3>

<p>The availability of useful trained deep neural networks for fast image classification based on Caffe and Tensorflow adds a new level of possibility to computer vision applications. GoCV can now load Caffe and Tensorflow models, and then use them as part of your Golang application. Check out this example code which in less than 40 lines of Go code uses the Tensorflow &ldquo;Inception&rdquo; model for image recognition on an incoming video camera feed:</p>

<pre><code class="language-go">package main

import (
    &quot;fmt&quot;
    &quot;image&quot;

    &quot;gocv.io/x/gocv&quot;
)

func main() {
    webcam, _ := gocv.VideoCaptureDevice(0)
    img := gocv.NewMat()
    net := gocv.ReadNetFromTensorflow(&quot;/path/to/tensorflow_inception_graph.pb&quot;)

    for {
        // read image from camera
        webcam.Read(img)

        // convert to a 224x244 image blob that can be processed by Tensorflow
        blob := gocv.BlobFromImage(img, 1.0, image.Pt(224, 244), gocv.NewScalar(0, 0, 0, 0), true, false)
        defer blob.Close()

        // feed the blob into the classifier
        net.SetInput(blob, &quot;input&quot;)

        // run a forward pass thru the network
        prob := net.Forward(&quot;softmax2&quot;)
        defer prob.Close()

        // reshape the results into a 1x1000 matrix
        probMat := prob.Reshape(1, 1)
        defer probMat.Close()

        // determine the most probable classification, and display it
        _, maxVal, _, maxLoc := gocv.MinMaxLoc(probMat)
        fmt.Printf(&quot;maxLoc: %v, maxVal: %v\n&quot;, maxLoc, maxVal)

        gocv.WaitKey(1)
    }
}
</code></pre>

<p>For a complete example using GoCV with Tensorflow take a look at <a href="https://github.com/hybridgroup/gocv/blob/master/cmd/tf-classifier/main.go">https://github.com/hybridgroup/gocv/blob/master/cmd/tf-classifier/main.go</a>.
For an example using GoCV with Caffe take a look at <a href="https://github.com/hybridgroup/gocv/blob/master/cmd/caffe-classifier/main.go">https://github.com/hybridgroup/gocv/blob/master/cmd/caffe-classifier/main.go</a>.</p>

<h3 id="recognizing-faces-with-the-intel-computer-vision-sdk-beta-r3">Recognizing Faces With The Intel Computer Vision SDK Beta R3</h3>

<p>We now offer complete support for the Intel Computer Vision SDK Beta R3. Of special note, we added the Photography Vision Library (PVL) FaceRecognizer algorithm. The FaceRecognizer is an efficient and simple interface to this very common feature needed for many CV applications. You can just load in a PVL FaceDetector and a FaceRecognizer like this:</p>

<pre><code class="language-go">fd := pvl.NewFaceDetector()
fr := pvl.LoadFaceRecognizer(&quot;/path/to/db.xml&quot;)
</code></pre>

<p>And then use them to detect and recognize faces from the video camera:</p>

<pre><code class="language-go">for {
    webcam.Read(img)
    gocv.CvtColor(img, imgGray, gocv.ColorBGRToGray)

    // detect faces
    faces := fd.DetectFaceRect(imgGray)
    if len(faces) &gt; 0 {
        // try to recognize the face
        personIDs, _ = fr.Recognize(imgGray, faces)

        // set the color of the box based on if the face is recognized
        color := blue
        msg := &quot;Unknown&quot;
        if len(personIDs) &gt; 0 &amp;&amp; personIDs[0] != pvl.UnknownFace {
            color = green
            msg = strconv.Itoa(personIDs[0])
        }

        // draw a rectangle the face on the original image,
        // along with text identifing if recognized
        rect := faces[0].Rectangle()
        gocv.Rectangle(img, rect, color, 3)

        size := gocv.GetTextSize(msg, gocv.FontHersheyPlain, 1.2, 2)
        pt := image.Pt(rect.Min.X+(rect.Min.X/2)-(size.X/2), rect.Min.Y-2)
        gocv.PutText(img, msg, pt, gocv.FontHersheyPlain, 1.2, color, 2)
    }

    // show the image in the window, and wait 1 millisecond
    window.IMShow(img)
    window.WaitKey(1)
}
</code></pre>

<p>The complete example using GoCV with the Intel CV SDK FaceRecognizer is at <a href="https://github.com/hybridgroup/gocv/blob/master/cmd/pvl/facerecognizer/main.go">https://github.com/hybridgroup/gocv/blob/master/cmd/pvl/facerecognizer/main.go</a>.</p>

<p>There are other cool capabilities of the Intel CV SDK such as hardware acceleration that are automatically supported when you use it with GoCV.</p>

<h3 id="and-there-s-even-more">And There&rsquo;s Even More</h3>

<p>We&rsquo;ve had many other excellent contributions this release, with updates to the new OpenCV 3.4, improvements to GoCV  core, more imgproc filters, new feature detection algorithms, many bugfixes, and documentation enhancements, including how to maximize compilation speed when including GoCV in your own applications. Thank you so very much to our contributors, especially all of our first-timers!</p>

<h3 id="keep-sight-of-what-we-re-up-to">Keep Sight of What We&rsquo;re Up To</h3>

<p>There are many improvements being made to GoCV, thanks to the very active community forming around Golang for computer vision applications. Please follow us on Twitter at <a href="https://twitter.com/GoCVio">@GoCVio</a> for the latest and greatest news about the project.</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/blog/" title="Blog"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/blog/2017-12-14-putting-eyes-on-the-iot-video/" title="Putting Eyes on the IoT - The Video" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1516791598"></script>
    <script src="/js/perfect-scrollbar.min.js?1516791598"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1516791598"></script>
    <script src="/js/jquery.sticky-kit.min.js?1516791598"></script>
    <script src="/js/featherlight.min.js?1516791598"></script>
    <script src="/js/html5shiv-printshiv.min.js?1516791598"></script>
    <script src="/js/highlight.pack.js?1516791598"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1516791598"></script>
    <script src="/js/learn.js?1516791598"></script>
    <script src="/js/hugo-learn.js?1516791598"></script>

    <link href="/mermaid/mermaid.css?1516791598" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1516791598"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

